---
- name: apt | install build dependencies for Ruby
  apt: pkg={{item}} state=present
  with_items:
    - build-essential
    - libcurl4-openssl-dev
    - libmysqlclient-dev
    - libssl-dev
    - libxml2-dev
    - libxslt1-dev
    - zlib1g-dev
  when: ansible_pkg_mgr == "apt"
  sudo: yes

- name: yum | install build dependencies for Ruby
  yum: name={{item}} state=present
  with_items:
    - openssl-devel
  when: ansible_pkg_mgr == "yum"
  sudo: yes

- name: git | clone rbenv
  git: repo=https://github.com/sstephenson/rbenv.git
       dest=~/.rbenv
       depth=1
       version=master
       update=yes

- name: file | ~/.rbenv/cache == directory
  file: path=~/.rbenv/cache
        state=directory

- name: file | ~/.rbenv/plugins == directory
  file: path=~/.rbenv/plugins
        state=directory

- name: git | clone rbenv-vars
  git: repo=https://github.com/sstephenson/rbenv-vars.git
       dest=~/.rbenv/plugins/rbenv-vars
       depth=1
       version=master
       update=yes

- name: git | clone rbenv-gem-rehash
  git: repo=https://github.com/sstephenson/rbenv-gem-rehash.git
       dest=~/.rbenv/plugins/rbenv-gem-rehash
       depth=1
       version=master
       update=yes

- name: git | clone ruby-build
  git: repo=https://github.com/sstephenson/ruby-build.git
       dest=~/.rbenv/plugins/ruby-build
       depth=1
       version=master
       update=yes

- name: file | ~/.rbenv/tmp == directory
  file: path=~/.rbenv/tmp
        state=directory
